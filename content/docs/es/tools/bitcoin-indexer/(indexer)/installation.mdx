---
title: Instalación
description: Instale PostgreSQL y compile el Indexador de Bitcoin desde el código fuente en sistemas Linux.
---
## Requisitos previos

Antes de instalar el Indexador de Bitcoin, asegúrate de tener:

* Un nodo de Bitcoin completamente sincronizado (ver [Configuración de nodo Bitcoin](/tools/bitcoin-indexer/full-sync))
* Ubuntu 20.04+ o Debian 11+
* Al menos 32GB de RAM
* 2TB+ de almacenamiento NVMe rápido

Instale los paquetes de sistema requeridos:

```terminal
$ sudo apt update
$ sudo apt install -y build-essential git curl pkg-config libssl-dev
```

## Instalar PostgreSQL

El Indexador de Bitcoin requiere PostgreSQL 14 o superior para almacenar datos de metaprotocolo.

### Agregar repositorio de PostgreSQL

```terminal
$ sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
$ curl -fsSL https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/postgresql.gpg
$ sudo apt update
```

### Instalar PostgreSQL 17

```terminal
$ sudo apt install postgresql-17
$ echo 'export PATH=/usr/lib/postgresql/17/bin:$PATH' >> ~/.bashrc
$ source ~/.bashrc
```

### Configurar el directorio de datos de PostgreSQL

Crea un directorio de datos personalizado para PostgreSQL:

```terminal
$ mkdir -p ~/bitcoin-indexer/pgdata
$ sudo chown -R postgres:postgres ~/bitcoin-indexer/pgdata
```

Inicializar el clúster de la base de datos:

```terminal
$ sudo -u postgres env "PATH=$PATH" initdb -D ~/bitcoin-indexer/pgdata
[32mThe files belonging to this database system will be owned by user "postgres".[0m
[32mThis user must also own the server process.[0m
```

### Iniciar servidor PostgreSQL

```terminal
$ sudo -u postgres env "PATH=$PATH" pg_ctl -D ~/bitcoin-indexer/pgdata start
[32mserver starting[0m
```

Verifique que PostgreSQL esté en ejecución:

```terminal
$ sudo -u postgres psql -c "SELECT version();"
```

### Crear bases de datos

Crear bases de datos separadas para cada metaprotocolo:

```terminal
$ sudo -u postgres createdb -p 5432 ordinals
$ sudo -u postgres createdb -p 5432 brc20
$ sudo -u postgres createdb -p 5432 runes
```

Establece la contraseña del usuario postgres:

```terminal
$ sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'postgres';"
[32mALTER ROLE[0m
```

:::callout
type: warn

### Nota de seguridad

Utilice una contraseña segura en producción. La contraseña predeterminada 'postgres' es solo para desarrollo.
:::

## Instalar Rust

El Indexador de Bitcoin está escrito en Rust. Instale la última versión estable:

```terminal
$ curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
$ source $HOME/.cargo/env
$ rustc --version
rustc 1.75.0 (82e1608df 2023-12-21)
```

## Construir Indexador de Bitcoin

### Clonar el repositorio

```terminal
$ cd ~/bitcoin-indexer
$ git clone https://github.com/hirosystems/bitcoin-indexer.git
$ cd bitcoin-indexer
```

### Construir desde el código fuente

```terminal
$ cargo build --release
   [32mCompiling[0m bitcoin-indexer v0.1.0
   [32mFinished[0m release [optimized] target(s) in 4m 23s
```

El binario compilado estará en `target/release/bitcoin-indexer`.

:::callout
### Tiempo de compilación

La compilación inicial tarda entre 5 y 10 minutos. Las compilaciones posteriores son mucho más rápidas debido al almacenamiento en caché.
:::

### Crear enlace simbólico para acceso global

```terminal
$ sudo ln -s ~/bitcoin-indexer/bitcoin-indexer/target/release/bitcoin-indexer /usr/local/bin/bitcoin-indexer
```

Verificar instalación:

```terminal
$ bitcoin-indexer --version
bitcoin-indexer 0.1.0
```

## Crear estructura de directorios

Configura los directorios necesarios para el indexador:

```terminal
$ mkdir -p ~/bitcoin-indexer/{rocksdb-chainstate,archives,logs}
```

Propósitos de los directorios:

* `rocksdb-chainstate/` - Almacena el estado indexado de la cadena de bloques
* `archives/` - Archivos descargados del archivo para bootstrap
* `logs/` - Registros de aplicación y errores

## Configurar servicio systemd

Crear un servicio systemd para el inicio automático:

```bash title="/etc/systemd/system/bitcoin-indexer.service"
[Unit]
Description=Bitcoin Metaprotocol Indexer
After=network.target postgresql.service bitcoind.service

[Service]
Type=simple
User=bitcoin-indexer
Group=bitcoin-indexer
WorkingDirectory=/home/bitcoin-indexer/bitcoin-indexer

ExecStart=/usr/local/bin/bitcoin-indexer ordinals service start --config-path=/home/bitcoin-indexer/bitcoin-indexer/bitcoin-indexer-config.toml
Restart=on-failure
RestartSec=30

# Process management
KillMode=mixed
KillSignal=SIGTERM
TimeoutStopSec=300

# Security
NoNewPrivileges=true
PrivateTmp=true

[Install]
WantedBy=multi-user.target
```

Habilitar el servicio:

```terminal
$ sudo systemctl daemon-reload
$ sudo systemctl enable bitcoin-indexer
```

## Verificar instalación

Verifique que todos los componentes estén instalados correctamente:

```terminal
$ # Check Bitcoin node
$ bitcoin-cli getblockcount
820000

$ # Check PostgreSQL
$ sudo -u postgres psql -l | grep -E "ordinals|brc20|runes"
 ordinals  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 brc20     | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 runes     | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |

$ # Check indexer binary
$ bitcoin-indexer --help
Bitcoin Indexer - High-performance metaprotocol indexing engine
```

:::next-steps
* [Configurar el indexador](/tools/bitcoin-indexer/configuration): Configurar bitcoin-indexer-config.toml
* [Arranque desde archivos](/tools/bitcoin-indexer/archive-bootstrap): Acelerar la sincronización inicial con datos preindexados
:::
