---
title: Bitcoin predicates
description: A list of predicates for using Chainhook with Bitcoin. The predicates are specified based on if-this, then-that constructs.
---

### `if_this` specifications

Get any transaction matching a given transaction ID (`txid`).

```jsonc
// [!code word:txid]
{
  "if_this": {
    "scope": "txid",
    "equals": "0xfaaac1833dc4883e7ec28f61e35b41f896c395f8d288b1a177155de2abd6052f"
  }
}
```

The `txid` mandatory argument requires a 32-byte hex-encoded type.

---


Get any transaction, where its `OP_RETURN` payload starts with a set of characters.

```jsonc
// [!code word:outputs]
// [!code word:starts_with]
{
  "if_this": {
    "scope": "outputs",
    "op_return": {
      "starts_with": "ab"
    }
  }
}
```

The `starts_with` mandatory argument admits an ASCII string type (such as `ab`) or hex encoded bytes (such as `0x6162`).

---

Get any transaction where its `OP_RETURN` payload is equals to a set of characters.

```jsonc
// [!code word:outputs]
// [!code word:equals]
{
  "if_this": {
    "scope": "outputs",
    "op_return": {
      "equals": "0x616263"
    }
  }
}
```

The mandatory argument for `equals` accepts either an ASCII string type (such as `abc`) or hex encoded bytes (such as `0x616263`).

---

Get any transaction where its `OP_RETURN` payload ends with a set of characters.

```jsonc
// [!code word:outputs]
// [!code word:ends_with]
{
  "if_this": {
    "scope": "outputs",
    "op_return": {
      "ends_with": "0x6263"
    }
  }
}
```

The mandatory argument for `ends_with` accepts either an ASCII string type (such as `bc`) or hex encoded bytes (such as `0x6263`).

---

Get any transaction with a p2pkh output paying a given recipient.

```jsonc
// [!code word:outputs]
// [!code word:p2pkh]
{
  "if_this": {
    "scope": "outputs",
    "p2pkh": {
      "equals": "mr1iPkD9N3RJZZxXRk7xF9d36gffa6exNC"
    }
  }
}
```

The `p2pkh` construct admits an ASCII string type: `"mr1iPkD9N3RJZZxXRk7xF9d36gffa6exNC"`.

Or a hex encoded bytes type: `"0x76a914ee9369fb719c0ba43ddf4d94638a970b84775f4788ac"`.

<Callout>
`p2pkh`(Pay-to-Public-Key-Hash) is a Bitcoin transaction output script type that allows users to send funds to a recipient's hashed public key, providing security and privacy by concealing the actual public key.
</Callout>

---

Get any transaction including a p2sh output paying a given recipient.

```jsonc
// [!code word:outputs]
// [!code word:p2sh]
{
  "if_this": {
    "scope": "outputs",
    "p2sh": {
      "equals": "2MxDJ723HBJtEMa2a9vcsns4qztxBuC8Zb2"
    }
  }
}
```

The `p2sh` construct accepts the following types:
  - A string type: `"2MxDJ723HBJtEMa2a9vcsns4qztxBuC8Zb2"`.
  - A hex encoded bytes type: `"0x76a914ee9369fb719c0ba43ddf4d94638a970b84775f4788ac"`.

<Callout>
`p2sh`(Pay-to-Script-Hash) is a Bitcoin transaction output script type that enables users to send funds to a script instead of a public key, allowing for more complex transaction conditions and multi-signature addresses.
</Callout>

---

Get any transaction, including a `p2wpkh` output paying a given recipient.

```jsonc
// [!code word:outputs]
// [!code word:p2wpkh]
{
  "if_this": {
    "scope": "outputs",
    "p2wpkh": {
      "equals": "bcrt1qnxknq3wqtphv7sfwy07m7e4sr6ut9yt6ed99jg"
    }
  }
}
```

The `p2wpkh` construct accepts a string type, for example: `"bcrt1qnxknq3wqtphv7sfwy07m7e4sr6ut9yt6ed99jg"`.

<Callout>
`p2wpkh`(Pay-to-Witness-Public-Key-Hash) is a Bitcoin transaction output script type used in Segregated Witness (SegWit) that allows for more efficient and secure transactions by separating the witness data from the transaction data and storing it in a separate block.
</Callout>

---

Get any transaction, including a `p2wsh` output paying a given recipient.

```jsonc
// [!code word:outputs]
// [!code word:p2wsh]
{
  "if_this": {
    "scope": "outputs",
    "p2wsh": {
      "equals": "bc1qklpmx03a8qkv263gy8te36w0z9yafxplc5kwzc"
    }
  }
}
```

The `p2wsh` construct accepts a string type, for example: "bc1qklpmx03a8qkv263gy8te36w0z9yafxplc5kwzc".

<Callout>
`p2wsh` (Pay-to-Witness-Script-Hash) is a Bitcoin transaction output script type used in Segregated Witness (SegWit) that enables users to send funds to a hashed script, allowing for more complex transaction conditions and greater scalability by separating the script from the transaction data.
</Callout>

<Accordions>
<Accordion title="Wallet descriptors">
Wallet descriptors provide a compact and semi-standardized method for describing how scripts and addresses within a wallet are generated. Chainhook users that want to track addresses derived from an extended pubkey or a multisig-wallet can now rely on this feature instead of defining one predicate per address.
For example, let's say we wanted to track the first 3 addresses generated by the following descriptor:

```
wpkh(tprv8ZgxMBicQKsPePxn6j3TjvB2MBzQkuhGgc6oRh2WZancZQgxktcnjZJ44XdsRiw3jNkbVTK9JW6KFHvnRKgAMtSyuBevMJprSkZ4PTfmTgV/84'/1'/0'/0/*)
```

This descriptor reads: describe a P2WPKH output with the specified extended public key, and it produces these BIP84 addresses:

```
bcrt1qzy2rdyvu8c57qd8exyyp0mw7dk5drsu9ewzdsu
bcrt1qsfsjnagr29m8h3a3vdand2s85cg4cefkcwk2fy
bcrt1qauewfytqe5mtr0xwp786r6fl39kmum2lr65kmj
```

The predicate should then be defined like this:

```json
{
  "if_this": {
    "scope": "outputs",
    "descriptor": {
      "expression": "wpkh(tprv8ZgxMBicQKsPePxn6j3TjvB2MBzQkuhGgc6oRh2WZancZQgxktcnjZJ44XdsRiw3jNkbVTK9JW6KFHvnRKgAMtSyuBevMJprSkZ4PTfmTgV/84'/1'/0'/0/*)",
      "range": [0, 3]
    }
  }
}
```
</Accordion>
</Accordions>

---

Get any Bitcoin transaction, including a block commitment. Broadcasted payloads include _Proof of Transfer_ reward information.

```jsonc
// [!code word:stacks_protocol]
// [!code word:block_committed]
{
  "if_this": {
    "scope": "stacks_protocol",
    "operation": "block_committed"
  }
}
```

Proof of Transfer (PoT) is the [blockchain consensus mechanism for Stacks](https://www.hiro.so/blog/securing-web3-apps-through-bitcoin-an-overview-of-stacks-consensus-mechanism) where miners can bid BTC for the chance to mine Stacks blocks.

---

Get any transaction, including a key registration operation.

```jsonc
// [!code word:stacks_protocol]
// [!code word:leader_registered]
{
  "if_this": {
    "scope": "stacks_protocol",
    "operation": "leader_registered"
  }
}
```

---

Get any transaction including a new Ordinal inscription (inscription revealed and transferred).

```jsonc
// [!code word:ordinals_protocol]
// [!code word:inscription_feed]
{
  "if_this": {
    "scope": "ordinals_protocol",
    "operation": "inscription_feed"
  }
}
```

---

Get any transaction, including a STX transfer operation.

```jsonc
// [!code word:stacks_protocol]
// [!code word:stx_transferred]
{
  "if_this": {
    "scope": "stacks_protocol",
    "operation": "stx_transferred"
  }
}
```

---

Get any transaction, including a STX lock operation.

```jsonc
// [!code word:stacks_protocol]
// [!code word:stx_locked]
{
  "if_this": {
    "scope": "stacks_protocol",
    "operation": "stx_locked"
  }
}
```

### `then_that` constructs

The following `then_that` constructs are supported:

`HTTP Post` block/transaction payload to a given endpoint:

- `http_post` construct admits:
  - url (string type), like `http://localhost:3000/api/v1/wrapBtc`
  - authorization_header (string type).

```jsonc
{
  "then_that": {
    "http_post": {
      "url": "http://localhost:3000/api/v1/wrapBtc",
      "authorization_header": "Bearer cn389ncoiwuencr",
    },
  },
}
```

Append events to a file through the filesystem, which is convenient for local tests:

- `file_append` construct admits:
  - path (string type). Path to the file on disk.

```jsonc
{
  "then_that": {
    "file_append": {
      "path": "/tmp/events.json",
    },
  },
}
```

### Additional configuration knobs available

The following additional configurations can be used to improve the performance of Chainhook by preventing a full scan of the blockchain.

Ignore any block before the given block:

```json
"start_block": 101
```

Ignore any block after the given block:

```json
"end_block": 201
```

Stop evaluating a chainhook after a given number of occurrences are found:

```json
"expire_after_occurrence": 1
```

Don't include proofs:

```json
"include_proof": false
```

Don't include proofs:

```json
"include_proof": false
```

Don't include Bitcoin transaction inputs in the payload:

```json
"include_inputs": false
```

Don't include Bitcoin transaction outputs in the payload:

```json
"include_outputs": false
```

Don't include Bitcoin transaction outputs in the payload:

```json
"include_outputs": false
```

Don't include Bitcoin transaction witnesses in the payload:

```json
"include_witness": false
```

Don't include Bitcoin transaction witnesses in the payload:

```json
"include_witness": false
```

<Accordions>
  <Accordion title="Example predicate definition with multiple networks">
  ```json
  {
    "chain": "bitcoin",
    "uuid": "1",
    "name": "Wrap BTC",
    "version": 1,
    "networks": {
      "testnet": {
        "if_this": {
          "scope": "ordinals_protocol",
          "operation": "inscription_feed"
        },
        "then_that": {
          "http_post": {
            "url": "http://localhost:3000/api/v1/ordinals",
            "authorization_header": "Bearer cn389ncoiwuencr"
          }
        },
        "start_block": 10200
      },
      "mainnet": {
        "if_this": {
          "scope": "ordinals_protocol",
          "operation": "inscription_feed"
        },
        "then_that": {
          "http_post": {
            "url": "http://my-protocol.xyz/api/v1/ordinals",
            "authorization_header": "Bearer cn389ncoiwuencr"
          }
        },
        "start_block": 90232
      }
    }
  }
  ```
  </Accordion>
</Accordions>
